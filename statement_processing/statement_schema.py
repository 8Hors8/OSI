"""
statement_schema.py

Модуль описывает ожидаемую структуру Excel-ведомости ОСИ.

Содержит набор констант и соответствий, определяющих:
- обязательные названия листов ведомости;
- логическое назначение каждого листа;
- соответствие типов банковских платежей листам ведомости.

Модуль не содержит логики обработки данных и используется
как схема (contract) ведомости для валидаторов, менеджеров
и аналитических модулей.
"""


class ExpectedSheets:
    """
        Контейнер констант, описывающий структуру листов ведомости ОСИ.

        Класс определяет:
        - канонические названия листов Excel;
        - полный набор обязательных листов ведомости;
        - соответствие типов счетов из банковских данных
          конкретным листам ведомости.

        Используется для:
        - валидации структуры загруженной ведомости;
        - маршрутизации платежей по листам;
        - централизованного хранения имен листов,
          чтобы избежать "магических строк" в коде.
    """
    DELIVERY_APARTMENTS = 'разноска по квартирам'
    CURRENT_PAYMENT = 'оплата текущ  и пени'
    CUMULATIVE_PAYMENT = 'оплата накоп'
    PAYMENT_PURPOSE = 'оплата целев'

    ALL_SHEETS = {
        DELIVERY_APARTMENTS,
        CURRENT_PAYMENT,
        CUMULATIVE_PAYMENT,
        PAYMENT_PURPOSE,
    }

    CORRESPONDENCE = {
        'текущий счет': CURRENT_PAYMENT,
        'накопительный счет': CUMULATIVE_PAYMENT,
        'целевой счет': PAYMENT_PURPOSE,
    }


class ApartmentsSchema(ExpectedSheets):
    # =========================
    # 1. Идентификация листа
    # =========================

    # Имя Excel-листа, из которого производится чтение данных
    NAME_SHEET = ExpectedSheets.DELIVERY_APARTMENTS


    # =========================
    # 2. Координаты заголовка
    # =========================

    # Строка, в которой расположен заголовок нужного столбца
    ROW_START = 3

    # Колонка, в которой расположен заголовок нужного столбца
    COLUMN_START = 2

    # Ожидаемый текст заголовка (используется для проверки структуры листа)
    EXPECTED_VALUE = "номер квартиры"


    # =========================
    # 3. Параметры сканирования
    # =========================

    # Тип обхода данных:
    # "row"    — сканирование вниз по строкам
    # "column" — сканирование вправо по колонкам
    # "mixed"  — табличное сканирование (строки + колонки)
    SCAN_TYPE = "row"

    # Смещение начала сканирования по строкам
    # (сколько строк пропустить после заголовка)
    ROW_OFFSET = 4

    # Смещение начала сканирования по колонкам
    # (обычно 0 для сканирования по строкам)
    COLUMN_OFFSET = 0


    # =========================
    # 4. Типизация данных
    # =========================

    # Ожидаемый тип значений (используется для приведения и валидации)
    VALUE_TYPE = int

    # Разрешены ли пустые значения (None, пустая ячейка)
    ALLOW_EMPTY = False


    # =========================
    # 5. Правила уникальности
    # =========================

    # Требовать ли уникальные значения
    # (для номеров квартир дубликаты недопустимы)
    UNIQUE = True


    # =========================
    # 6. Ограничения значений
    # =========================

    # Минимально допустимое значение
    MIN_VALUE = 1

    # Максимально допустимое значение
    # None — без верхнего ограничения
    MAX_VALUE = None


    # =========================
    # 7. Фильтрация и остановка
    # =========================

    # Значения, которые следует игнорировать при сканировании
    IGNORE_VALUES = {None, "", "-"}


